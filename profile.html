{% extends "base.html" %}
{% block content %}
<div class="max-w-lg mx-auto bg-white p-8 rounded-xl shadow">
  <h2 class="text-2xl font-bold mb-4">Profile</h2>
  <div class="mb-4 text-sm text-gray-600">Username: <strong>{{ current_user.username }}</strong></div>

  {% if current_user.totp_secret %}
    <div class="mb-4 p-4 bg-green-50 border rounded">
      <div class="font-medium">Two-Factor Authentication is enabled</div>
      <div class="text-sm text-gray-600 mt-1">Save your authenticator secret safely.</div>
    </div>
    <form method="POST" class="space-y-3">
      <input type="hidden" name="action" value="disable">
      <button type="submit" class="px-4 py-2 bg-red-600 text-white rounded-md">Disable 2FA</button>
    </form>
  {% else %}
    <div class="mb-4 p-4 bg-yellow-50 border rounded">
      <div class="font-medium">Two-Factor Authentication is not enabled</div>
      <div class="text-sm text-gray-600 mt-1">Enable 2FA for extra security (TOTP).</div>
    </div>
    <form method="POST" class="space-y-3">
      <input type="hidden" name="action" value="enable">
      <button type="submit" class="px-4 py-2 bg-indigo-600 text-white rounded-md">Enable 2FA</button>
    </form>
  {% endif %}

  {% if otp_uri %}
    <div class="mt-6 p-4 bg-gray-50 rounded">
      <div class="text-sm mb-2">Provisioning URI (paste into authenticator or generate QR):</div>
      <div class="font-mono text-xs break-all bg-white p-2 border rounded">{{ otp_uri }}</div>
      <div class="mt-3 text-sm text-gray-500">Secret: <code>{{ secret }}</code></div>
    </div>
  {% endif %}
</div>
{% endblock %}
